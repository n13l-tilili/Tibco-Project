
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>📩 Clôture Expédition PMU</title>
  <style>
    body {
      background-color: #121212;
      color: #e0f7fa;
      font-family: "Segoe UI", sans-serif;
      padding: 40px;
    }
    h1 {
      text-align: center;
      color: #4fc3f7;
      margin-bottom: 30px;
    }
    .form-section {
      max-width: 700px;
      margin: auto;
      background-color: #1f1f1f;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 12px rgba(79,195,247,0.3);
    }
    label {
      display: block;
      margin: 14px 0 6px;
      font-weight: bold;
      color: #4fc3f7;
    }
    input {
      width: 100%;
      padding: 10px;
      background-color: #2c2c2c;
      border: 1px solid #4fc3f7;
      border-radius: 8px;
      color: white;
    }
    .btn-row {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-top: 20px;
    }
    .btn-row button {
      background-color: #263238;
      color: #4fc3f7;
      border: 1px solid #4fc3f7;
      border-radius: 8px;
      padding: 8px 14px;
      font-size: 14px;
      cursor: pointer;
      transition: 0.3s;
    }
    .btn-row button:hover {
      background-color: #37474f;
    }
    #mail-output {
      margin-top: 40px;
      background-color: #1e1e1e;
      padding: 20px;
      border-radius: 12px;
      box-shadow: inset 0 0 8px #4fc3f7;
      white-space: pre-wrap;
    }
    .mail-table {
      width: 100%;
      margin-top: 20px;
      border-collapse: collapse;
      font-family: 'Segoe UI', sans-serif;
      background-color: #1e1e1e;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 0 12px rgba(79, 195, 247, 0.2);
      color: white;
    }
    .mail-table th, .mail-table td {
      padding: 14px;
      border: 1px solid #4fc3f7;
      text-align: center;
    }
    .mail-table th {
      background-color: #263238;
      color: #4fc3f7;
      text-transform: uppercase;
    }
  </style>
</head>
<body>
  <h1>🔧 Clôture Expédition PMU bloquée</h1>

<div style="text-align: center; margin-top: -10px; margin-bottom: 30px;">
  <span style="display: inline-block; background: rgba(0,191,255,0.08); padding: 12px 24px; border-radius: 12px; box-shadow: 0 0 8px rgba(0,191,255,0.4); color: #aee4ff; font-size: 15px;">
    🔷 Cette page est dédiée à l’envoi d’un message à la coordination PMU (RO/RP) pour forcer la clôture d’une expédition bloquée dans Ti-Stock.
  </span>
</div>

  <div class="form-section">
    <label for="inter">📌 N° Intervention</label>
    <input type="text" id="inter" placeholder="Ex : E737XXXX" />

    <label for="bon">🚚 Bon de Transport</label>
    <input type="text" id="bon" placeholder="Ex : 1Y23456789" />

    <label for="sn">🔍 Numéro de Série</label>
    <input type="text" id="sn" placeholder="Ex : PMU123456789" />

    <div class="btn-row">
      <button onclick="generateMail()">📨 Générer</button>
      <button onclick="copyMail()">📋 Copier</button>
      <button onclick="exportHTML()">💾 HTML</button>
    </div>
  </div>

  <div id="mail-output"></div>

  <script>
    function generateMail() {
      const inter = document.getElementById('inter').value.trim();
      const bon = document.getElementById('bon').value.trim();
      const sn = document.getElementById('sn').value.trim();

      
      const mail = `
<div style="background:#111; padding: 30px; border-radius: 16px; box-shadow: 0 0 16px rgba(0,191,255,0.5); max-width:800px; margin:auto; font-family: 'Segoe UI', sans-serif; color: white; line-height: 1.2;">
  Bonjour,<br><br>
  Je vous contacte afin de demander la clôture manuelle d’une expédition PMU qui semble actuellement bloquée sur Ti-Stock.<br>
  🚫 Une ligne rouge apparaît en bas de page, m'empêchant de clôturer l’intervention manuellement.<br>
  📦 Le colis est déjà prêt à partir avec le livreur TNT. Le bon de transport a bien été créé et collé sur le carton.<br>
  ✅ Une fois la clôture effectuée de votre côté, tout sera bon de mon côté.<br><br>
  <table style="width:100%; border-collapse:collapse; margin-top:15px; box-shadow: 0 0 10px rgba(0,191,255,0.3); border-radius: 10px; overflow: hidden;">
    <thead>
      <tr style="background-color:#1e1e1e; color:#00bfff;">
        <th style="border:1px solid #333; padding:12px;">📌 N° Intervention</th>
        <th style="border:1px solid #333; padding:12px;">🚚 Bon de Transport</th>
        <th style="border:1px solid #333; padding:12px;">🔍 N° de Série</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td style="border:1px solid #333; padding:12px; background-color:#181818; color:white;">${inter}</td>
        <td style="border:1px solid #333; padding:12px; background-color:#181818; color:white;">${bon}</td>
        <td style="border:1px solid #333; padding:12px; background-color:#181818; color:white;">${sn}</td>
      </tr>
    </tbody>
  </table><br>
  Merci d’avance pour votre aide 😊
</div>
      `;
    
      document.getElementById('mail-output').innerHTML = mail;
    }

    function copyMail() {
      const content = document.getElementById('mail-output').innerHTML;
      const blob = new Blob([content], { type: 'text/html' });
      const data = [new ClipboardItem({ 'text/html': blob })];
      navigator.clipboard.write(data).then(() => {
        alert("✂️ Mail copié avec style !");
      });
    }

    function exportHTML() {
      const content = document.getElementById('mail-output').innerHTML;
      const blob = new Blob([content], { type: 'text/html' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "mail_cloture_pmu.html";
      a.click();
    }
  </script>

<div id="notif" style="display:none; position: fixed; bottom: 20px; right: 20px; background: #263238; color: #4fc3f7;
padding: 10px 20px; border-radius: 8px; box-shadow: 0 0 10px #4fc3f7; font-size: 14px; z-index: 999;">
  ✅ Mail copié avec style !
</div>

<script>
  function showNotif(message) {
    const notif = document.getElementById("notif");
    notif.textContent = message;
    notif.style.display = "block";
    setTimeout(() => { notif.style.display = "none"; }, 3000);
  }

  function copyMail() {
    const content = document.getElementById('mail-output').innerHTML;
    const blob = new Blob([content], { type: 'text/html' });
    const data = [new ClipboardItem({ 'text/html': blob })];
    navigator.clipboard.write(data).then(() => {
      showNotif("✅ Mail copié avec style !");
    });
  }

  function exportHTML() {
    const content = document.getElementById('mail-output').innerHTML;
    const blob = new Blob([content], { type: 'text/html' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "mail_cloture_pmu.html";
    a.click();
    showNotif("💾 Fichier HTML exporté !");
  }
</script>
</body>

</html>
