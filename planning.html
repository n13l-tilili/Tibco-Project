
<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Planning Techniciens</title>
  <style>
    body {
      margin: 0;
      background-color: #000;
      color: #fff;
      font-family: 'Segoe UI', sans-serif;
    }

    h1 {
      text-align: center;
      margin: 30px 0 10px;
      font-size: 2.5em;
      color: #00d4ff;
      text-shadow: 0 0 8px #00d4ff88;
    }

    .presence-summary {
      background: #111;
      max-width: 900px;
      margin: auto;
      border-radius: 16px;
      padding: 20px;
      box-shadow: 0 0 12px #00d4ff44;
      margin-bottom: 30px;
    }

    .presence-summary h2 {
      text-align: center;
      color: #00d4ff;
      margin-bottom: 12px;
    }

    .presence-summary ul {
      list-style: none;
      padding: 0;
      margin: 0;
      text-align: center;
    }

    .presence-summary li {
      padding: 6px 0;
      font-size: 1.1em;
      border-bottom: 1px solid #ffffff11;
    }

    .planning-container {
      max-width: 1200px;
      margin: auto;
      background-color: #121212;
      padding: 20px;
      border-radius: 20px;
      box-shadow: 0 0 20px #00d4ff22;
    }

    table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      border-radius: 16px;
      overflow: hidden;
    }

    th, td {
      border: 1px solid #333;
      padding: 12px;
      text-align: center;
    }

    th {
      background-color: #1a1a1a;
      color: #00d4ff;
      font-weight: 600;
    }

    td {
      background-color: #1b1b1b;
    }

    .glow {
      background-color: #2c3e50;
      box-shadow: 0 0 12px #00d4ffcc;
      border: 1px solid #00d4ff;
    }

    .day-off {
      background-color: #2a2a2a !important;
      color: #888;
      font-style: italic;
    }

    input[type="text"], input[type="time"] {
      background-color: #1a1a1a;
      color: white;
      border: none;
      padding: 6px;
      border-radius: 6px;
      width: 90%;
      text-align: center;
    }

    .button-row {
      text-align: center;
      margin-top: 20px;
    }

    .button-row button {
      background-color: #00d4ff;
      color: #000;
      font-weight: bold;
      border: none;
      padding: 10px 20px;
      margin: 10px;
      border-radius: 10px;
      cursor: pointer;
      transition: 0.3s;
    }

    .button-row button:hover {
      background-color: #00b0d6;
    }
  </style>
</head>
<body>
  <h1>üìÖ Planning des Techniciens</h1>

  <div class="presence-summary">
    <h2>üìç Pr√©sents ce Mardi</h2>
    <ul id="todayList"><li>Chargement...</li></ul>
  </div>

  <div class="planning-container">
    <table id="planningTable">
      <thead>
        <tr>
          <th>Technicien</th>
          <th>Lundi</th><th>Mardi</th><th>Mercredi</th><th>Jeudi</th><th>Vendredi</th><th>Samedi</th><th>Dimanche</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <div class="button-row">
      <button onclick="addRow()">‚ûï Ajouter un technicien</button>
      <button onclick="exportJSON()">üíæ Exporter en JSON</button>
    </div>
  </div>

<script>
  const todayIndex = 1;

  function addRow(nom = "", horaires = []) {
    const row = document.createElement("tr");
    let html = `<td><input type="text" value="${nom}" placeholder="Technicien"></td>`;
    for (let i = 0; i < 7; i++) {
      const start = horaires[i]?.[0] || "";
      const end = horaires[i]?.[1] || "";
      const isToday = i === todayIndex;
      const glow = (isToday && start && end) ? "glow" : "";
      const dayoff = (!start && !end) ? "day-off" : "";
      html += `<td class="${glow || dayoff}">
        <input type="time" value="${start}" placeholder="REPOS"> √† 
        <input type="time" value="${end}" placeholder="REPOS">
      </td>`;
    }
    row.innerHTML = html;
    document.querySelector("#planningTable tbody").appendChild(row);
    attachListeners();
    updateTodayPresence();
  }

  function updateTodayPresence() {
    const list = document.getElementById("todayList");
    list.innerHTML = "";
    let found = false;
    document.querySelectorAll("#planningTable tbody tr").forEach(row => {
      const name = row.querySelector("input[type='text']").value;
      const cell = row.querySelectorAll("td")[todayIndex + 1];
      const inputs = cell.querySelectorAll("input");
      if (inputs.length === 2 && inputs[0].value && inputs[1].value) {
        const start = inputs[0].value;
        const end = inputs[1].value;
        const li = document.createElement("li");
        li.innerHTML = `<strong>${name}</strong> : ${start} ‚Üí ${end}`;
        list.appendChild(li);
        cell.classList.add("glow");
        cell.classList.remove("day-off");
        found = true;
      } else {
        cell.classList.remove("glow");
        cell.classList.add("day-off");
      }
    });
    if (!found) {
      list.innerHTML = "<li>Aucun technicien pr√©vu aujourd‚Äôhui.</li>";
    }
  }

  function exportJSON() {
    const rows = document.querySelectorAll("#planningTable tbody tr");
    const data = Array.from(rows).map(row => {
      const nom = row.querySelector("input[type='text']").value;
      const horaires = Array.from(row.querySelectorAll("td")).slice(1).map(td => {
        const inputs = td.querySelectorAll("input");
        return inputs.length === 2 ? [inputs[0].value, inputs[1].value] : ["", ""];
      });
      return { nom, horaires };
    });
    const blob = new Blob([JSON.stringify(data, null, 2)], { type: "application/json" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "planning.json";
    a.click();
    URL.revokeObjectURL(url);
  }

  function attachListeners() {
    document.querySelectorAll("input").forEach(input => {
      input.removeEventListener("input", updateTodayPresence);
      input.addEventListener("input", updateTodayPresence);
    });
  }

  window.addEventListener("DOMContentLoaded", () => {
    addRow("MAMY", [["09:00","17:00"],["09:00","17:00"],["09:00","17:00"],["09:00","17:00"],["09:00","17:00"],["",""],["",""]]);
    addRow("HICHEM", [["09:00","17:00"],["09:00","17:00"],["09:00","17:00"],["09:00","17:00"],["09:00","17:00"],["",""],["",""]]);
    addRow("MEHDI", [["","",""],["","",""],["09:00","17:00"],["09:00","17:00"],["09:00","17:00"],["09:00","17:00"],["09:00","17:00"]]);
    addRow("SEBASTIEN", [["09:00","17:00"],["09:00","17:00"],["09:00","17:00"],["09:00","17:00"],["09:00","17:00"],["",""],["",""]]);
  });
</script>
</body>
</html>
